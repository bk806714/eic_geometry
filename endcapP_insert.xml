<lccdd>
  <define>
    <include ref="ip6/definitions.xml" /> 
    <include ref="compact/definitions.xml" />
    <include ref="compact/configuration_default.xml"/>

    <constant name="EndcapPInsert_AirThickness"      value="0.02*cm"/>
    <constant name="EndcapPInsert_AbsorberThickness" value="1.61*cm"/>
    <constant name="EndcapPInsert_ScintThickness"    value="0.30*cm"/>
    <constant name="EndcapPInsert_PCBThickness"      value="0.16*cm"/>
    <constant name="EndcapPInsert_ESRThickness"      value="0.015*cm"/>
  </define>

  <includes>
    <gdmlFile ref="compact/elements.xml"/>
    <gdmlFile ref="compact/materials.xml"/>
  </includes>

  <limits>
  </limits>

  <regions>
  </regions>

  <display>
  <include ref="compact/colors.xml" />
  </display>
  
  <comment> Including the central beampipe </comment>
  <include ref="ip6/central_beampipe.xml" />

  <detectors>
  
  <comment>
    These layers currently ignore the scintillator cover
  </comment>
    <detector
      id="EndcapPInsert_ID" 
      name="EndcapPInsert" 
      type="EndcapPInsert"
      readout="HcalEndcapPInsertHits">
      <position x="EndcapPInsert_xpos" y="0*m" z="EndcapPInsert_zmin"/>
      <rotation x="0" y="0" z="0"/>
      <dimensions 
        x="EndcapPInsert_xtotal"
        y="EndcapPInsert_ytotal"
        z="EndcapPInsert_length"/>
      <layer 
        repeat="EndcapPInsert_numLayers" 
        thickness = "EndcapPInsert_AirThickness + 
                      EndcapPInsert_AbsorberThickness +
                      EndcapPInsert_ESRThickness + 
                      EndcapPInsert_ScintThickness +
                      EndcapPInsert_ESRThickness + 
                      EndcapPInsert_PCBThickness +
                      EndcapPInsert_AirThickness ">
        <slice 
          name="Absorber_slice"
          material="Tungsten"
          thickness="EndcapPInsert_AbsorberThickness"
          radiator="yes" 
          vis="AnlGray"/>
        <slice
          name="Air_slice"
          material="Air"
          thickness="EndcapPInsert_AirThickness"
          vis="Invisible"/>
        <slice
            name="ESRfoil_slice"
            material="Polystyrole"
            thickness="EndcapPInsert_ESRThickness"
            vis="Invisible" /> 
        <slice 
          name="Scint_slice"
          material="PlasticScint126"
          thickness="EndcapPInsert_ScintThickness"
          vis="AnlOrange"
          sensitive="true"/>
        <slice
          name="ESRfoil_slice"
          material="Polystyrole"
          thickness="EndcapPInsert_ESRThickness"
          vis="Invisible" />
        <slice
          name="PCB_slice"
          material="Fr4"
          thickness="EndcapPInsert_PCBThickness"
          vis="AnlBlue"/>
        <slice
          name="Air_slice"
          material="Air"
          thickness="EndcapPInsert_AirThickness"/>
      </layer>
        <beampipe_region 
          initial_beampipe_radius="EndcapPInsert_opening_radius"
          final_beampipe_radius="EndcapPInsert_final_radius"/>
    </detector>


    <detector id="9"
              name="LeakageDetector"
              type="EndcapPInsert"
              readout="LeakedHits">
      <position x="0*m" y="0*m" z="5.05*m"/>
      <rotation x="0" y="0" z="0"/>
      <dimensions x="120*cm" y="120*cm" z="103.2*cm"/>
      <layer repeat="50">
         <slice name="Scint_slice" material="PlasticScint126" thickness="EndcapPInsert_ScintThickness" vis="AnlOrange" sensitive="trye"/>
        <slice name="Absorber_slice"  material="Tungsten"         thickness="EndcapPInsert_AbsorberThickness"  vis="AnlGray"/>

      </layer>
      <beampipe_region
          initial_beampipe_radius="0.0*mm"
          final_beampipe_radius="0.1*mm"
          beampipe_crossing_angle="CrossingAngle"/>
    </detector>

  </detectors>

  <readouts>
    <readout name="HcalEndcapPInsertHits">
      <segmentation 
        type="CartesianGridXY"
        grid_size_x="3.*cm"
        grid_size_y="3.*cm"/>
      <id>system:8,barrel:3,module:4,layer:8,slice:5,x:32:-16,y:-16</id>  
    </readout>

    <readout name="LeakedHits">
      <segmentation
        type="CartesianGridXY"
        grid_size_x="3.*cm"
        grid_size_y="3.*cm"/>
      <id>system:8,barrel:3,module:4,layer:8,slice:5,x:32:-16,y:-16</id>
    </readout>


    
  </readouts>

  <plugins>
  </plugins>

  <fields>
  </fields>

</lccdd>
